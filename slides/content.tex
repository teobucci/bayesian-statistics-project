%!TEX root = ./main.tex


\section{Background}

%Gaussian graphical models-------------------------------
\subsection{Gaussian Graphical Models}
\begin{frame}{Gaussian Graphical Models}
    Models for the \textbf{conditional dependence structure} among variables, represented through an undirected graph $G=(V,E)$
    \begin{align*}
    \bm{y}_{1}, \ldots, \bm{y}_{n} \mid \bm{K} &\iid N_{p}(\bm{0},\bm{K}^{-1}), \bm{K}=\Sigma^{-1}, \bm{K} \in \mathbb{R}^{p\times p}  %%%%add bold
    \end{align*}
Conditional independence described through a \textbf{map} between a \textbf{graph} and a family of multivariate \textbf{probability models}
\begin{align*}
X_{i}\perp X_{j} \mid X_{-(ij)} \iff (i,j) \notin E \iff k_{ij}=0
\end{align*}
Usual prior for $\bm{K}$ conditionally to the graph is a G-Wishart
\begin{align*}
    \bm{K} \mid G &\iid \text{G-Wishart}(B,d)
\end{align*}
$G$ is a r.v. in the space of undirected graphs with p nodes.\\
If we assume a possible \textbf{grouping} of the variables, we need a prior $\pi(G)$ that induces a \textbf{block structure on its adjacency matrix}.
%How to introduce an appropriate prior $f_{z}(\mathbf{z})$ for the \alert{partition} and the conditional distribution OR  DENSITY???$f_{G}(G \mid \mathbf{z})$ for the \alert{edge generation}? 
\end{frame}


%%TO DO @Teo 
%Add numeration of formulas from 1 to 4 - HO CAMBIATO IDEA FORSE MI PIACE DI PIU' COSI' COME  E' ORA
%Add bold sigma
%Add the image - STAVO PENSANDO, MA SE NE METTESSIMO DUE? UNA CON UN GRAFO CON ELEMENTI DA 1 A P STRUTTURA E UNA TABELLA - OK CHE E' SIMILE A QUELLO DI COLOMBI BUT STILL


%%

 



%Stochastic Block Models -----------------------
\subsection{Stochastic Block Models}

\begin{align*}
    G_{ij} \mid \mathbf{z} &\ind\  f_{G}(G \mid \mathbf{z}) , 1 \le i < j \le p \\ %alternativr G_{ij} \in {Edges}
    \mathbf{z} &\iid\ f_{z}(\mathbf{z}), \mathbf{z} \in \mathbb{R}^p
\end{align*}


\begin{frame}{Stochastic Block Models}
    Statistical models for \alert{community detection}: given a random network of data, infere a node partition based on similarity of connectivity patterns\\

    \begin{columns}
        \begin{column}{0.30\textwidth}
            \begin{align*}
                G_{ij} \mid \Theta,z \overset{\mathrm{iid}}{\sim} Be(\theta_{ij}),  G \in \mathbb{R}^{p \times p}, \\
                \theta_{ij} = \Theta_{z_{i}z_{j}}, 1 \le i < j \le p \\ 
                \Theta_{rs} \overset{\mathrm{iid}}{\sim} Beta(\alpha, \beta)\\
                \mathbf{z} \overset{\mathrm{iid}}{\sim} \pi_{z}(\mathbf{z}), \mathbf{z} \in \mathbb{R}^p
            \end{align*}
            \end{column}
        \begin{column}{0.30\textwidth}
            \alert{Adjacency matrix G}
            \begin{table}[htpb]
            %\setlength{\arrayrulewidth}{1pt}
            \centering
            \begin{tabular}{c|c|c|c|c|c|} 
            \hline
            1   & &    &    &   &     \\ 
            \hline
            2  &  $y_{21}$ &    &    &   &     \\ 
            \hline
            ...  &   &    &    &   &     \\ 
            \hline
            ...  &   &    &    &   &     \\ 
            \hline
            N  & $y_{n1}$   &    &    &   &  
            \end{tabular}
            \end{table}
        \end{column}


        \begin{column}{0.25\textwidth}
        %\centering
        \alert{Cluster matrix $\Theta$}

        Inserire come nelle note mie e di Andre, sistemare anche la adjacency matrix
        \end{column}

    \end{columns}



    \begin{center}
    Critical task: \alert{identification of the number of clusters H}
    \end{center}


\end{frame}















\begin{frame}{Choosing the prior for the number of clusters}

\begin{columns}

\begin{column}{0.5\textwidth} 

    Number of clusters H usually estimated \textit{before} running the model
    \begin{itemize}
        \item prior knowledge
        \item BIC
        \item Cross-validation methods
    \end{itemize}
\end{column}

\begin{column}{0.5\textwidth}
    Problems: underestimation of model uncertainty (?). prediction: impossible to classify elements in a new cluster
\end{column}
\end{columns}

\alert{Extended stochastic block models (ESBM)}\\  
Use priors for z that naturally allow to increase the number of groups, e.g., 
    \begin{itemize}
        \item Chinese restaurant process (CRP)
        \item Mixture of finite mixtures (MFM)
    \end{itemize}

Most of the ESBM models do not pose constraints\\ on the \alert{ordering of the elements} in the partition
\end{frame}








%Changepoint models------------------
\subsection{Changepoint Models}
\begin{frame}{Changepoint Models}
    %\fg{0.4}{changepoint}
    Consider a process where at certain \textbf{changepoints} the underlying generating mechanism changes. Let $\bm{x}=(x_{1},\ldots,x_{n})$ be \textbf{ordered} observations each depending on a $\vartheta_{i}.$\\
    \[
        f(x_{1},\ldots,x_{n} \mid \vartheta_1, \vartheta_2, \ldots, \vartheta_{k+1}, \bm{z})=\prod_{j=1}^{k+1} \prod_{i=\tau_{j-1}+1}^{\tau_j} f(x_i \mid \vartheta_j)
    \]
    where $\tau_j$ are changepoint times and $z_{i} = 1$ if it's a changepoint, $0$ otherwise.
    We borrow the concept of \textbf{generating a random partition with ordering constraints}:\footnote{$\vartheta$ can be marginalized out.}
    \begin{align*}
        \pi(\bm{z}, \bm{\vartheta} \mid \bm{y}) & \propto f(\bm{y} \mid \bm{\vartheta}, \bm{z}) \pi(\bm{\vartheta} \mid \bm{z}) \pi(\bm{z}) \\
        &=\left(\prod_{j=1}^{k+1} \prod_{i=\tau_{j-1}+1}^{\tau_j} f(y_i \mid \vartheta_j)\right)\left(\prod_{j=1}^{k+1} \pi(\vartheta_j)\right) \pi(\bm{z})
    \end{align*}
\end{frame}








%----------------------------------------
% Project goals
%-------------------------------------
\section{Project goals}


\begin{frame}[containsverbatim]{Goal of the project}

Propose a \alert {new flexible prior that accounts for a random partition of the nodes}, respects their ordering constraints and allows to learn a block structured graph

 \begin{itemize}
     \item Ordering Constraint: borrow ideas from changepoint models
     \item Random partition: nonparametric prior on ordered partitions
     \item Block Structure: use a stochastic block model prior
 \end{itemize}



\end{frame}

\section{Next steps}
\begin{frame}

forse dovremmo capire meglio quali sono i next steps

\begin{itemize}
    \item sampling strategy
    \item simulation strategy
\end{itemize}



\centering \Huge 
\end{frame}




\begin{frame}{Bibliography}
    \nocite{bensonAdaptiveMCMCMultiple2018}
    \nocite{martinezNonparametricChangePoint2014}
    \renewcommand*{\bibfont}{\tiny}
    \printbibliography
\end{frame}

\section*{Questions}


\begin{frame}{Extra slide 1}
metterei le formule di 
\begin{itemize}
    \item Dirichlet multinomial
    \item CRP
    \item Mixture of finite mixtures (not strictly necessary)

    

\end{itemize} 
\end{frame}



%\begin{frame}
%    \tableofcontents
%\end{frame}



% \begin{frame}{All together}
%     \emph{``Are you getting it? These are not three separate devices: This is one device''}
%     \fg{1}{steve-mod}
% \end{frame}


% Use starred version (e.g. \section*{Section name})
    % to disable (sub)section page.
    \section{Section 1}
    \subsection{Subsection 1.1}
    \begin{frame}{Simple frame}
        This is a simple frame.
    \end{frame}

    \begin{frame}[plain]{Plain frame}
        This is a frame with plain style and it is numbered.
    \end{frame}
    
    \subsection{Subsection 1.2}
    \begin{frame}[t]
        This frame has an empty title and is aligned to top.
    \end{frame}
    
    \begin{frame}[noframenumbering]{No frame numbering}
        This frame is not numbered and is citing reference \cite{knuth74}.
    \end{frame}
    
    \begin{frame}{Typesetting and Math}
        The packages \texttt{fontenc} and \texttt{FiraSans}\footnote{\url{https://fonts.google.com/specimen/Fira+Sans}}\textsuperscript{,}\footnote{\url{http://mozilla.github.io/Fira/}} are used to properly set the main fonts.
        \vfill
        This theme provides styling commands to typeset \emph{emphasized}, \alert{alerted}, \textbf{bold}, \dots
        \vfill
        \texttt{FiraSans} also provides support for mathematical symbols:
        \begin{align*}
            e^{i\pi} + 1 & = 0, \\
            \int_{-\infty}^\infty e^{-x^2}\,\mathrm{d}x & = \sqrt{\pi}.
        \end{align*}
    \end{frame}

    \section{Section 2}
    \begin{frame}{Blocks}
        \begin{block}{Block}
            Text.
        \end{block}
        \pause
        \begin{alertblock}{Alert block}
            Alert \alert{text}.
        \end{alertblock}
        \pause
        \begin{exampleblock}{Example block}
            Example
        \end{exampleblock}
    \end{frame}
    
    %\begin{frame}{Lists}
    %    \begin{columns}[t, onlytextwidth]
    %        \column{0.33\textwidth}
    %            Items:
    %            \begin{itemize}
    %                \item Item 1
    %                \begin{itemize}
    %                    \item Subitem 1.1
    %                    \item Subitem 1.2
    %                \end{itemize}
    %                \item Item 2
    %                \item Item 3
    %            \end{itemize}
    %        
    %        \column{0.33\textwidth}
    %            Enumerations:
    %            \begin{enumerate}
    %                \item First
    %                \item Second
    %                \begin{enumerate}
    %                    \item Sub-first
    %                    \item Sub-second
    %                \end{enumerate}
    %                \item Third
    %            \end{enumerate}
    %        
    %        \column{0.33\textwidth}
    %            Descriptions:
    %            \begin{description}
    %                \item[First] Yes.
    %                \item[Second] No.
    %            \end{description}
    %    \end{columns}
    %\end{frame}
\setbeamertemplate{caption}[numbered]
    \begin{frame}{Figures and Tables}
        \begin{columns}
            \column{0.4\textwidth}
                \begin{figure}
                    \centering
                    \includegraphics[scale=0.15]{../report/images/logo-polimi-transparent}
                    \caption{Figure caption.}
                    \label{fig:focuslogo}
                \end{figure}
                
            \column{0.6\textwidth}
                \begin{table}
                    \centering
                    \begin{tabular}{rcc}
                         & Heading 1 & Heading 2 \\\hline
                        Row 1 & \(v_{11}\) & \(v_{12}\) \\
                        Row 2 & \(v_{21}\) & \(v_{22}\) \\
                        Row 3 & \(v_{31}\) & \(v_{32}\) \\
                    \end{tabular}
                    \caption{Table caption.}
                    \label{tab:demo}
                \end{table}
        \end{columns}
    \end{frame}

    
    \begin{frame}{Backup frame}
        This is a backup frame, useful to include additional material for questions from the audience.
        \vfill
        The package \texttt{appendixnumberbeamer} is used not to number appendix frames.
    \end{frame}

\begin{frame}
    Thank you!
\end{frame}